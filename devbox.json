{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/0.16.0/.schema/devbox.schema.json",
  "packages": [
    "volta@latest",
    "uv@latest",
    "github:anomalyco/opencode/v1.1.51",
    "gh@latest"
  ],
  "env": {
    "VOLTA_FEATURE_PNPM":  "1",
    "PUPPETEER_CACHE_DIR": "$DEVBOX_PROJECT_ROOT/.cache/puppeteer",
    "OPENCODE_CONFIG":     "$DEVBOX_PROJECT_ROOT/opencode_project.jsonc"
  },
  "shell": {
    "init_hook": [
      "mkdir -p \"$PUPPETEER_CACHE_DIR\"",
      "CHROME_HEADLESS_SHELL_PATH=\"$(pnpm dlx puppeteer browsers install chrome-headless-shell 2>/dev/null | tail -n 1 | awk '{print $2}')\"",
      "if [ -z \"$CHROME_HEADLESS_SHELL_PATH\" ]; then CHROME_HEADLESS_SHELL_PATH=\"$(find \"$PUPPETEER_CACHE_DIR\" -type f -name 'chrome-headless-shell' -perm -u+x 2>/dev/null | head -n 1)\"; fi",
      "export PUPPETEER_EXECUTABLE_PATH=\"$CHROME_HEADLESS_SHELL_PATH\"",
      "echo \"PUPPETEER_EXECUTABLE_PATH=$PUPPETEER_EXECUTABLE_PATH\"",
      "pnpm dlx puppeteer browsers install chrome-headless-shell",
      "echo 'Welcome to Kintone Plugin Development Environment!'",
      "echo 'Loading environment variables from $DEVBOX_PROJECT_ROOT/.env if present...'",
      "if [ -f $DEVBOX_PROJECT_ROOT/.env ]; then set -a; . $DEVBOX_PROJECT_ROOT/.env; set +a; fi",
      "echo 'Development environment ready!'"
    ],
    "scripts": {
      "spec": [
        "volta run --node latest pnpm dlx @pimzino/spec-workflow-mcp@latest --dashboard"
      ]
    }
  }
}
